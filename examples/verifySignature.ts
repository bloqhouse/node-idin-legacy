import xml, { SignedXml, xpath } from 'xml-crypto'
import { DOMParser } from 'xmldom'

const MyKeyInfo = function(this: any, key1: string) {
  this.getKeyInfo = (privateKey: any, prefix: string) => {
    return `<KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName>`
  }

  this.getKey = (keyInfo: any) => {
    return `-----BEGIN CERTIFICATE-----
MIIDzjCCAragAwIBAgIGAVdRyiTvMA0GCSqGSIb3DQEBCwUAMIGKMQswCQYDVQQG
EwJOTDEWMBQGA1UECBMNTm9vcmQgSG9sbGFuZDESMBAGA1UEBxMJQW1zdGVyZGFt
MRkwFwYDVQQLExBJbnRlcm5ldCBCYW5raW5nMRswGQYDVQQKExJBQk4gQU1STyBC
YW5rIE4uVi4xFzAVBgNVBAMTDnd3dy5hYm5hbXJvLm5sMB4XDTE2MDkyMjEyMDYy
NFoXDTE5MDkyMjEyMDYyNFowgYoxCzAJBgNVBAYTAk5MMRYwFAYDVQQIEw1Ob29y
ZCBIb2xsYW5kMRIwEAYDVQQHEwlBbXN0ZXJkYW0xGTAXBgNVBAsTEEludGVybmV0
IEJhbmtpbmcxGzAZBgNVBAoTEkFCTiBBTVJPIEJhbmsgTi5WLjEXMBUGA1UEAxMO
d3d3LmFibmFtcm8ubmwwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCd
EPU6zMZWeRA4HJrmd6BOletvBJJ7E8aTVwQ8X4Y3ulEjghk0HjAYN7GzHIu9fyTX
HEYWr1ewQZyqzzv4o6PfA/k3qRoLpqDjRWMQV38n/Bz+w3q50MT9HyC9+SJ4oWL3
FkPMyI0iOtgXLvSkQ9eUVzCQx2rgpftOXfcdaWiJrELwCT1GTxputqDE6pThfBze
P38uPbcdDAVltOUKLS/uH7xweTpKamA+VAozRlDm4JzOG8vrHgjHztfwpW5+sv19
gDje7bOWFDgqK+HNh4XHCW5OsfvXO4BoYvUVJZCpdLGsy62D8k3HDbmlnB+As4qj
LBM32CGVCvjLEsf+pb9JAgMBAAGjODA2MAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/
BAQDAgWgMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4IB
AQB5hj4RSq0XGqe0HIKL4sj+E40pECas7YEh0dKm6ZowFqJZy4+B8T3uztA348va
3yrPTQx7N4vBLupnrQQ2dX+Ut1LmavTDIpQDvHW1X7EoGBI7JWY3gIX/eUjTnEDJ
qn1U9zVTMEvypfxoHIM5UbyCf+b2eitgqPqHp4r3TyPmNEGUgvleofUTlPc8v8UF
oq4Vtm4mhTLcpi5A/jOdjTkEiHRsivzRyeSXpYszL6Mo6Z7yrxRjstUf3Pw467Ii
Jur8mQC/7X5ir8N7rS9Dp8waYRt8qbgf6xXfG6HALungkpiM11WQLuNoPKwhMZAW
VmT926W9yWIvNndcaHyseijI
-----END CERTIFICATE-----`
  }
} as any

const DOM = new DOMParser()
const XML = new SignedXml()
XML.keyInfoProvider = new MyKeyInfo('iDIN_ABN_PROD_merchant.cer')

// tslint:disable:max-line-length
const response = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><awidxma:AcquirerStatusRes xmlns:awidxma=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns:awenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:awsamac=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:awsamdce=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" xmlns:awsamecp=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:awsammeta=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:awvssamlass=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:awvssamlprot=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:awvsxmldsig=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:awvsxmlenc=\"http://www.w3.org/2001/04/xmlenc#\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <awidxma:createDateTimestamp>2017-10-25T18:18:19.694Z</awidxma:createDateTimestamp>\n    <awidxma:Acquirer>\n        <awidxma:acquirerID>0030</awidxma:acquirerID>\n    </awidxma:Acquirer>\n    <awidxma:Transaction>\n        <awidxma:transactionID>0030000020095118</awidxma:transactionID>\n        <awidxma:status>Success</awidxma:status>\n        <awidxma:statusDateTimestamp>2017-10-25T18:18:19.530Z</awidxma:statusDateTimestamp>\n        <awidxma:container><saml2p:Response xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"RES-0030000020095118\" InResponseTo=\"BLQsuccesHIO100OIHtest\" IssueInstant=\"2017-10-25T18:18:19.567Z\" Version=\"2.0\"><saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">0030</saml2:Issuer><saml2p:Status><saml2p:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"><saml2p:StatusCode Value=\"urn:nl:bvn:bankid:1.0:status:Success\"/></saml2p:StatusCode></saml2p:Status><saml2:Assertion xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" ID=\"_a75adf55-01d7-40cc-929f\" IssueInstant=\"2017-10-25T18:18:19.568Z\" Version=\"2.0\"><saml2:Issuer>BANKNL2Y</saml2:Issuer><ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><ds:Reference URI=\"#_a75adf55-01d7-40cc-929f\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"xsd\"/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ds:DigestValue>uHP4ZCNhT496/lekbu2OK7ev57MTz9u3pI266ovUuQM=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>aeU28npIFnj0TKSqlJunO9YGjh6/EBJQ2GF6cCRxW9jxKfSUqFMGIO4TZ0/0FcxkIBhR/5N4/xLacJkQmTDx0dlg0nOR1F7x7wGxxUh0wXcXnMPNp+Ckwtpb4nduY4rX9W3SKPxkAv5apZZ+11N7R8MywUNf8dBbqzZZ80Umf3mJlMwhVMd2h8ic8IqVQRZ0/Jn9srwvDOb+E0mJzsuxYnv6kiPQry4lubqtg4J2mpvVC7BBmzIlt+NKpBdWyZpXgodcUeYREz8iIprsPbl5akhxp10wJp4DBjcX1MmB6mI3cRLhmSxd0d8slcSq0FglL1mWTBumxlHYCMe3TPwvVg==</ds:SignatureValue><ds:KeyInfo><ds:X509Data><ds:X509Certificate>MIIDbzCCAlegAwIBAgIEeCuDtTANBgkqhkiG9w0BAQsFADBoMQswCQYDVQQGEwJERTEMMAoGA1UECBMDTlJXMQ8wDQYDVQQHEwZBYWNoZW4xEjAQBgNVBAoTCVdvcmxkbGluZTESMBAGA1UECxMJV29ybGRsaW5lMRIwEAYDVQQDEwlXb3JsZGxpbmUwHhcNMTQwNzA4MTQwNDU1WhcNMTkwNzA3MTQwNDU1WjBoMQswCQYDVQQGEwJERTEMMAoGA1UECBMDTlJXMQ8wDQYDVQQHEwZBYWNoZW4xEjAQBgNVBAoTCVdvcmxkbGluZTESMBAGA1UECxMJV29ybGRsaW5lMRIwEAYDVQQDEwlXb3JsZGxpbmUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCmCC1wb07Zza4csVSMWJNhkZttvAjNYFPtlsHI6aZdLHy04BMx27lXFYexs8ZhNtyhniIaB8O3OV1cP03cI3tWa2Q55eX1BysvmDnTYMprHiFktYvSuXdN1PFa8NNswNSLMsgja3Tp+SrHYka0MtsgVM79Rk16ExvSaGmYO0OV5dx666yKVUCBV/lU/8tyIhHQAdTM4KGdWggfPbcI/KkJeSk3YPHY1LbmdpdGDS8UJcBwuOw3JII8cXj3oDPGQWuXVfKVE2iS9IiEjAipTlfvrA1yZqwfq6PcUSrVEWa++kr/zTzSUAwlIHXL8OpLzi0cGRgdtVEjcvO1DkUuQrdBAgMBAAGjITAfMB0GA1UdDgQWBBQfp6FTr4Fw6bVeVGY0XvVtEsEu6DANBgkqhkiG9w0BAQsFAAOCAQEAFrD2fcNCyKM346xYRJ84PDaLA2MagOy9pC0j18iFGsR+LZpALkYQQweM2Xu9IWs+IJdTC6gnuQzCedAAFF+ovXs5r0bwwG7cmtOfdYQh0tjDk515MbVeVSXSnROJLPJVjcNeeHfdSAfKhJE3bmDtfVsPVtkjbuh5waisKbswb53+aM63PgNHdHt9X5la0HhY1Ggdxd2UicSl5+6ffEmSMQ9jTh4JcUMMvhi4bZeVM4renRWjF5v8VITl6lLZy3lKDzip5Mw8g8mtaj1GsY55/Q60vFSvLJztwuQw249zImAZ4JAINmrIPfpDT6wnwnprRXwgvE4o3AAFYCyJuHTZmg==</ds:X509Certificate></ds:X509Data></ds:KeyInfo></ds:Signature><saml2:Subject><saml2:EncryptedID><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_962e6ed000d66c195ad908f203148055\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_2f8e0350e0226c76954ba907810e74f1\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>px1AMBV44LvZWDx+6yDjxTeiiAz4N7lQjjyYN7IawigBxpLl6V3xXYHqmr+FAtajCH4dNPI190F73CEGR/Lssw1mw/l3nliSe3G2h8n3pIZFsdAahg9h44A9oCOtbUnDpsnct1alqgd4MEVjXnUAb1D6U0+cXBEtOmZb54DhE9qmCBYHMlW1po+fGARULxsEfvAzJdw2+5km18GL6YBVEDqefg1cLP48yBb4ui7WQR0wj1Cb+C3fkD1uzd9pXSk/xX9rAzoWNuBXW5094NkbbHwaVAkx0bbePi9x7nAaYWz9uYMv6WsVC1BgZOWtVAujiknEF49h4U4CXe2gBJuWwg==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>not1NnJckkzmpg2JXzMmvmaybsUF2YqNJwhqCQwo7SrkmCM6KvU9QhKLVszALogHSwqVD/1L9XEpQrLf0LBmcS1OV9dMcPDRNHRP6yfYCvpDKfXNgLTCs0rSEtPfP7X5RRBfevH+7VzrsD1N+QwSqCGAYaLV+l/jjUbowlejDz63SU550F7XnSSgn/JBG428hqim3mI8bExyMOTGA0dN9O2TlFilcFQIQBt+d1BsMOHhzB9NgypAdMAgJnPwqkuR</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedID></saml2:Subject><saml2:Conditions NotBefore=\"2017-10-25T18:18:19.567Z\" NotOnOrAfter=\"2017-10-25T18:18:49.567Z\"><saml2:AudienceRestriction><saml2:Audience>WL Validation Srv</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement><saml2:Attribute Name=\"urn:nl:bvn:bankid:1.0:bankid.deliveredserviceid\"><saml2:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xsd:string\">21968</saml2:AttributeValue></saml2:Attribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_d5a49060d5e88d568bf9b452dc2b4555\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_8f5acf259270511be2a057cbab24b680\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>JrzsV+2TEFPJlx+XCJ9ZWdaKJZUpg9+DJiYKF8/xHwPcvV+yCDcnaGln5xgEUrqscaWrFVneaOPaEsrTJTjgtNhz0inLKolCXLb0qzsIgyJjvug9zdp+WCYgrY1dAFdKHJuLmGtZgA6HZ6UWod/T4YpU32eKrSOXt5aRODk/zZ0SDsaCEnSku3YDXik/U/xi18n6ICaHBuWm8PTnVpP5LE7Vtsk1625lVrzwxOkD4Csrwo6mUhoh9z96JYjZrYiHCLfLJSjISX/K0iOdpMs+dlKmJGEKB/tcjEM/pk7rgyMP6qpCChO+kpvjb+YdKhOpcGHO1nB9+ZVxP19rLr15Lw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>wlF7w3BayGkFfpfimClSyXfBI+B/NDjiwtSjZ14NnNFmdRgZjgtmXwI3zQAK6OFqUAOQphynHkqs2T5sCVDIyqjHt41r8mC5f36w9TDFw8u/yL7UX9/VzXvZE5V8hx2OmjTha/oPryv/uijGQZSvLoOS3gPKwNt0GM/w5AaYujHlFjnXm3UTRqjxyNOtDxOb6QPR/HLgTlYm4bLc93eEl3309dKkmpS+6qmqCDlCZohIsu1EV27h9sKKLiutjLgdw4Z/4zjmeLiQgVa5kAj74wRj3Im+3uRmxgHPZu8XP/ynzoLpcJXmd8CXnWyw2pV3TaZJCXu9cNSpk+7JWVpyFOyrJ8ZTcez1nAZtn56Nm6SikknodCnbQltAZVoMXRlW/FWV3nSfzGEXd1B67WsUPx0r0wO3joHxyS8aPPtA7GeV7qHTjmB+lZ1Dzv3Sz5RG</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_fcc6f91439b74049f2d1aa417149cea2\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_74a97a8cc5d53b945b91fc5853b17649\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>OcRHYr19SkWK4EBoc7mUVS0ngx1dvCX0nlFQBQss9kuLNP3SC55WzjHNMXhRZTSTIL4lD9N8mA8ser0U5+5533pB7zdCZi5RKr1kf+K2JxEfjJTgcu5Fn5MR2HooQZ19765DEG7WXOEule7BZJLswRfbct/Wjrv+3mUGSxO7yH1vukF/H++SiV/kn3vryKUEWUmY9M4jYCUMX33fRZGvCdVI3dS0fptLham3gmOGn2okhH/K90Z/uOKva9grK1F52sscR3r04ieTFGKDpeGSRUs/fxlIZSu61zhprzMh3a+GSGEeC3Sr5HMhihVl+/33QxLaMQ8ymX/VW/EkYGd2BA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>MC9vfhueQS4O1eiAWgpLzmSzDunCd8ra1tt6ycSHhZoP5wxKrj4nv80pmMNAj5qkILuluGobgni3JE3Ix9IO3oZwpgr8yfoPSiFzrj5a51uZHs0Tq6qDsBNGJzgbzS4/h01BmgjDNQqV9V1gtH7XAQzUDtKBkZcknmczE8ZA3Bk7+rgmgfaJWUE3veaU/18T5j2+mr11ag1t1qQJs7t+Kj37CpbfZu51nZ8WzyPDMEdgXE0zT1QivTgJvmiP0dHkXwBkGvxm2RZ4Ha+pgqz0XcqjLhs7NoKfG+G4cm3Zd/CHuQq5iKXIe3xWoe7g3K5sDB3x3Xs5Ac0UH6djWJLuJgfGA0kQMqZujzk8eANvuUgXiGTvbtQ2l+N+OzI2BpigsTXCFaRSR75/Qrv1CA2yT1qCZLdpxC1bv2LRL7ljsCJjR1kFKlHAtfTveXihHGOfoDsYsyapmChhh9eWJ5eT5Q==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_76b59c8103ce09f2a21de2b02395cfb7\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_fd19579191f8d99955e4a44c5de53255\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>W9WceDL0qbPtNiLZ3NCqgoqRXkkMF54tLqrc1wjbFogcw/qt/GtpLxrXLIQSEAlL3GXZaT7aRiIMutY0OpwINTc7AroE/nsC6m/BZN4vZ/TqgDz5DUTeb4MNM+FJrYpy+sW1mW55T6BwBsCAPa83ppUmRqtgSH2b0SJp2tb2ppgaDGJEpglawK7dAHbMUO8SJBX2zKkLmqHURK8uJ/P9pzwLbPGYtrcZAZX6md3I3xGzutgQOrGqB8Tcf09WG5MyEznXB6Gac0+AK6i1otWK7PQczlD7uMDYsn6yN+1wCNkYk3mh3lLBw+TzbUPM71Ddl4dcq8e1WzPGQbyqWQdarw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>N83OTxPI5WJGt0lEVZdYhS8SPbEIe8swZMRR1g/AtA+dwKfhamqygrM3aC2h0GeNSsGhpQ7/FZgYzOhpkJ8wkE9NijChZ54hx5/gzVH8o++XxN7VRO9SSCdGcmRzlpDUH6CdKP+B1ejbppmfgtqh4zy3Qu+JOx6cJI71c/Ajb6agK98oECJdD7cTd+3HHH19DPB9Ph2Yb0hVRNQAxM7pjrT64BRajN1xMq3W87tKGpF3tYXL3OJoy2L+yyGO3S38F2Cr3NfFDciDosMAwyiJ09h4TYEaO72X3cKWNoJVYLJbZ3DWpbAZ9MRTp03CXEhQY2C/Msv809IMwb65PYfr3/PlMmnnfze0dpJTE74vuFIP7qyNvoZMCnGHaEZJ7TCgJ0/rvEZOxcIRktPjRoLNx+eBySmMhhlB2uV/BIf7T6yxkO42Jq8YOcyrW2+M/9zs</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_81ce9620683f3f0123ccbda4b5869078\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_ee7112ca64d8a9cc8f402979cd3890e1\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>Qf99hzOQDyPz/Fp+q3Q1C1ni0VOJPQhvARrlhlEz035GqV8ILhAwII61iEKrPy+DzaYUO1gC3qt+HvepCorPN7V3II2fLcTqv80RpPiByWuahy8G8CEIC/dBM8ia1OEEPvkISyYtBZzmk2BFVqqUPPRN6XRzdo64xSFmwGABQ+M8YvMmVAlQuCfv36/XzyBNVeW5yufBSm0WDshyIcxC5L7w1MvtNGymHvvaBpyoWLV5ltcWR9ld6KEWL3kTMY3G0c6lT1/IEHxdBY4VqtStMluMQHzRfSJdkzwK/rcmsfY515vvKKk6s2g94+MdfS7bpTMRUeaVNWeEmMCHCi8LaA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>2s3XkRR0GmHIAlPL1F+IDEGkxaFafmE+Oy+LZsUBn+u3SDQXZlcwOmDhzgU+C4SIZpHMGrdNzFo+B/fYI9AGN+SrjtxVrN+181vp9izJDEcbifiFJpijhlnv0W0w4s7KYNWmOu+StMHGlzlQZIBLVFON4Dg+GjPN2T0uYYHWmgUaDFft6egt/tz++6TnToAPbWAXWPy6vPVjJBkDug+tT3tKD3xT2IRyV9/1Mt0rD+P2ajubTYm2TTJIU4FzGek2Jb0S0bbpQkGnCnBXHMsrviVmvlpjUxkrei6rMKcJxnfLHXXB/30CIsQhSZjhpM6tDj1fYeLb8Unq7yHDl2pYN5n813XvQkxDhEqGrhTce1iDKVgkaQ4hxLwmpOtznWAeXp5+SVGHtmGW7GXghnTRIyDLXbK7fcXfInlpZzrru9fRiBk8zXHzplb5v5Jco0cr</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_50457afb4a2050c5e6ad0b0e30ec1136\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_4c03efe7e3f9d6266aea15aad9c40f6e\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>BR9fI1xJ192sh/tRqe8kVLtMB86mUbjFkOIUsPCdRXr6zWQMqyDEea5fRpxJnFI8gT6m6IAxeWspBLi+uSnO3ryQd8g/wj5XxTL103n2B+NiyZ+poMHiIY7ikgT7dw0kSULUWyY65WjHSewEPgvlR7Ja4LMtxC60hinnIhAAux75H2d0DrzIw25hSz71RS42X3JapcxqVaLcmptyKt/RVx1PIsVdUhTUhe6TcQMTTfK1OCZlnXFl+xYwFS0atbWgVaFuTxAKiB7H0MR3e0cj7wWdxJ2dhaMYWUaeAI5XleM/ROY/n5IDh8vPCmIqirpnreOMlcYG4ycYRXY82f8GMQ==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>+NDdcyKiHixRQZTn2Vf9vKlQ8x5i7K+axGAW/HeoqlCvawDRqMvVGYq3t6RMzT2pnJKpeWYhzSftBBnN4+jxUQOw4FvBhL7sX6EzuC8wZ969qJ7reeixsdYRdsMJ0TJx8VlYmvYdhBVeDRqCpuYDy4/+i2UxBupxukE/OSXy8nJD5kf1gpCYP4IJJCfS+2LlxYyP0v/rt+7rbZFttCXm/5AS50elEfxnqlY74RdOTzWPsjqN/IBlauwqGGeOLNfl/xQBvoiGFPbLzXrHebJZZIhUkHEvAi9IPwcYu/dzzzBXCSFiAzI2GyRDTmRoQ24yC28h+oOFmPdyre0qhDQ4U2mLLklUC02GTGNjgZv0gSrO0Z+icdKnKF4yuhoU8pRcgLTH3FoDosOU+DekR8FirVfjLIQU6cHFOgFcaGWRVRXne1v+DNzCxxFpSDmrPm2N</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_78e1a62c49d46543780f3a5524edf097\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_7888348ce0769aca9698b563cd9b3adb\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>mCAQZxZoPDEWDSxpX+FpA6pXuHK/jah8h44ZZkjie1WgTvMqRJPVY4YAJra8nqUa8MAninSnM8Q6peT5KSYdEHTJXnQVizRQXNqWo/5peobjC3a81KURfd9RAJ37A5IyrgNrHlHdhftBQZPNZ7Jx3t/uUdU8sXCxLSNskihskeAsmppBrUoU9hPm/3i2jnWxGqa4QLd+rxVjcCIPztCBTquAxrg3BjlCpT0cqMhqD/WgkNhFJspP3wB21bJC6MdBj/hYk4d5+UD396sY/3PWfI8kD0+C75orFJTUpQyV3wPzQZ/xysBGhMdx5KcMIeVYlkIA9OZkZgEUBIArpTqdcw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>tlWba0ufjGs9Zylo8aSwrfgY1BwIyjFEZA00UFy+V0ae4aTQSVQQGHKh8AspWW823JlT9I4QSDzkF+ChOoGOFjm5Ekrg9qvcTCMfO4V2gItgJ80PGq4UeOaNBU++AG0oBTQt24NOLlM1xlWb5AyP5EWl1H9L5f2gjYGiJa2s1OWgpOk0N7QxHLo9GUfrnEtmESOPqajgKGe7Xz4XhcCvFPbBuTVpLK9j3v2yaRGapkCpZSBapd8hCXua68RYXNKGAnzHHW908YndBG0ntWYuVxcJWO8PW/Q/LcXMCI2tyJzCb26xMuLWViRTPCzA5mVFR2emx2b3GNK1xOizzoBhaMUOKUTfWoSwX5nuiFywcLky4Jvuk3+YptSPQbuYrIBQp6WPnAb8P0ecLGZahrhtqb78GUCzRZSB45U1SNPzp5QZT8hBxRVGkaI/bDlR5zme</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_086accdf3431fc3bddcec9d00ae96b11\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_a355539d6f61cc39a27b834298cf2081\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>gJMUZNXqHvtczvo8OvC4Q73Dh2Dr8xq1vE/MsW7Hpg3CxbleTjV4VQ1N5KhwQia4XBsMuJoUgC1MX0wxwz6WtRjmJCbVWfBrIiiiaFNldu6642G2x5FCxlo70rHwNUj5AmrsVywBPgGRCkHf5/f0qYzJYHmBN7wjK9aOE5tZDdNN0n5HeGSXT6ow+6ExZjtb57lcwY4DHU6cbdb3+2WhnrykzUAc/j/Xxfa9rgRI/X0vrJHTNhDKt/eymeTynuQNJVZlcquQ/AhulRzpIeb5cpBedXh8601pImi2rOtyuvpoxzsEHgvqqnVJFdJOB+lp4v6MmmOqLvwOCRak3chWKg==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>dSL36Gen0TcmHE9qaOi3lyBZwXMLRLP0TyjEUYAT8kX8tzgvEdCjljonsWJ5Q/XcPB96z2eLmfBCI3S6RbyMQC9MdUyqbWJ9T+fj739+pL1u+XCnd/sigSn5QS7TN7JqgV8XiVs0l6gb0pwAqDWbBHQTLPPFwp9rE8a3MxJ5rBDvvuwewYjeYrZkZJEBvzfl1dQlzUL9TN91hNabBGzU2Gwp6OIcKfe3H41OUtqePMDjGn4cCxOFLzxasq0dxzBbz9e/Rdr7rZsBSyLVQnGLgewz2P3cmFdS1/134nbhwNY7zkidA/40Fr1V0DmGUEc28e0HfA7RD2P8QO7T3e1yU+EubKUmgVZEQxJRoN7a//l8vi1/O8t+kj3IA9n7SDWK9D3DNPL0a0R0s254yRnHDlm2vITvlxhQ9VTH5aly9EI=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_2648727b4da4d13aeae5624466125e97\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_6a53effd64c3536dbda8a7dd4a728706\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>QxPdPdiFpxp155ctSjVU7vqqDKc3iY5rvBUQULtIpFfJopbMgp8NYXYyjkaopkD7a2aL0OQmX6/+CmE3f8yrv26M70B+ml8d9NO7u8o9Gk1EXRuJKYcNtgSU5lqCnLScUvHO9owR1U6SjpKy3P/FUXTP597+okTZr0bA+4d3kB1/SXGrVC6n0gdPLtjEJyKH9TenFoYLe27dPMyEmY1NjRrEaCDh3Qpfa96qm+ZMUxZt7tvvyyoPdY8G6qMTSsjiw13Gq8uy9CBvV1Epop0sxIGXGJfXCCKjJbgEnFj/6KV9bnd0kMKUvzea0wyJAmaajQxCOLsxh2vcfTbLQleSCA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>YshCZH+u04QnCl0ifQ3iudof3eB6UkGEZfOoOEKEDa1rZWL/tDCWyDl2m/dHD2g9fzNOCSm55xntPYubzWhY3Jic0ScK/uYQOUbBXCoZ8rs3T6xRvv67TyijnVE3Vvz9oJCwp6ng8cZ+F7vRI9g7H7t+AL645T4MGYCSEO2I9Lgw8gQxNbCDU0tAqIZCit+BunSbJ/tciJ9m1pYOi9wnJTc4u9waHT8l16//boNyUwy8Oc1MIugLHLXpr23QUMtzkCophuG6dFUFMDE3KbfKTkgGgfoypnMFsmzsyxpUqfMz8jfnvoIUrwoMygBampKvyOO78s1L2mjPXlEmRAo10h5bjQw+gF8aFtcQOLfFOxpsVPEkrw5LWAzSE+D2j24x7czhBcAEVZkMayMSLoVWNKm6cwjDG2zKOhUJSU/rZYoc00525m50aNLTguoCIAsA</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_1b2f4c92f6a7c328556234c6b6e387be\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_c6708d6bb295ab626685292d581c0938\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>NOMBKBbXtrODlKgyU3nMgyYBbv7g3c3o9OlE8B7Q2FfCq2v4VKAfvoXeDBqSBee4Xqo5W/x1r7O32XVO5iCl9lY2DwZ5DLVd9ttcxHsQQZhyezbwCpRZamVbo1I01WHKXOHiRg9dGFbmrgbXjb+0MoG5rJNKXjS/wYVyP2sZ+XemMF4dTvHpb4MMC6neEtG1widSvf6gdvAe1KH6EFdW1RjuycCCbJRhbO0HnnBBSj8MNmrxDhPM6dgs6dpGRrwoZQiNcGfWlKxRjfO6ec45U0cBfJ7C368G2JX98YNpEQluPc7SirNTFIXqAuRqxMU2d0HkLQzwNf3oxqVglLquRA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>KX+9cZ/29usf9eR8D298aVbW4me222D2yXBuqUHb/f4+PBq1b0ArMnUQT8Zya3o1bgDs24N6bW2bDyQJDjLNwu14oZd7PdWwqPlXH41vC06kUfv0CMKold6nDKrSXa6aDoQL7v7J5CXwXe8FGyBSP5LtpOwZcRRdCqEoDqEkJTPe6SLro5yD4dBhUQGA61QiXyOVBUOv9/zb7n+jCPB5Wh9WnXsRXs9dp61qrmZ32bYtJOsXOCvFJvVzzJkk4LkL9HTSmD6ah7ukot9vSlc1/7H88cFdRZCmXRInAigJU2Zwhbdl96sEt0SvhuaAalx0DbKV7lfbHxlNorobCJtx0QJXtblcLoWe+L91Lr8QsIhPvszVGl4h+CpxxgLUkq4XP0F/TXrC+uwFMS0qk+BxGopJvLx6YpetnypQ7v+IDo8=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_e1a7388ac4dfde8fb5066739fd86207e\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_e1ee0d34000f98b597d8dad98aba6d53\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>Za+9KNKIXeHKKlluyiuC6xi5zDnaYgWKwBkog4iXtxKqIych9M8RcYpuX9jc07S9drYAuS7nYy8UnrIzvnhk4ujHWvabuEBkdEetJmiPgQFPHpe4PaNjvymSdI5SxqFPpAZ/08Pjaoi5wfURsGCKdR/YvUt+udW4xtdjYfI+dAm4D9qMjaDGBprappYtDTAENMf806jEgM439TI6NZquS1a4A7pxoWc6YuCBAjG1nontXJFPC3VPCgh44vSkmhy1k6Zz28tjUwky1AQ3eGuRbQMAYGskBum+0i22qRmVdADAN23Na1ZZdEjsM2pA+JlGSnpxkCF+Rk/KDgDzWik4iw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>i6KVGve2icITu/Fhce/IY1CZtVYd48AD6AvdAJazTBcJvlUIRa7lSz6A6gLbY6eMRVEA6Xu/zmnxKxWGp1dAReGq5IXKPbDAoEKzFomgKxm5psj4qR9X+e3fuEF+8lYEW4/zoMdXM5etOW2bhbU+tcOzsMRTwKqpHaDxz+Gd8bEwPjQfbFslwn7rIoYPT9owiZ5lzFZtIHwJbKMRiyxJpawZvVFqyRkyqEFEPw2q7B9195JJScKjH6TvBOQ615ZNpe8+lnHXlGF1LdDTq4TMK07/+/6JF8j7sYPSursSthQk6kXwnPrFaehDdEkXitOsw5W8tyatIQlUVqOO77xwRS8HlrYmlphiRfjXx33MtvhUWk5cQYgPscO/H64m8C4ZGmr7JmHEnJX4SfcqGyxRCMiPjz9d6QG+HD5psru8u/DUbrlwwSEOw3m5Mruv80hH</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_4bd0ef3e5db63d96435448ac8cdf80ee\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_ece2b6d4fa10e43a40b35c6ed1a16b1e\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>rRvHQTrmzvTF6iCYrnpFzkmNj5g5c8X54Yzx5quDDqmbZkarAnL9h522SAzmsZSOBnWO19qLPO4rcPiFhHfoCZV7AypFLaYWGZzlhw1JuvPbR0bMERTOVoShJFblu9BUEbRaY+LwP8xWLIjbjxASjIJfUGb0KNfTXU7Dvlr7OH6RjVnzB60Z5/hYZ6W4XPySb3lz6XpZzYcT6oDmB021RZdum/F+0M6zxZxIGKR2f4niVWkqQhk0csnuIjHwj3xbVf45C7gutzIv0D60uM4+fzrPoW4yve07p8pOVVwZQnsaNYox8JNpUiGToYXVch08tY30vp+eGqemVgCYPca2/g==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>LmNUZq1zxgxYBvCk4v2jWUGXJ96QT9VV601u6XQv7UZ6fRYJmhbSnlLPE9q+GwBMfShbEjVZ0OIIeT9rCdjPYHw19vBcTQMhxG6GV1REyBMhj/RLP5uz43u6x925o55z1E3+qMSspgLsSxu4yskSovBO+RLgb+rjpX7fDCevZuG88ye7tFYBGwXSpGKnJSkMv6aDBuYlDA3fR8FGF8Ft718e/nxmhtCrXreJeuBjkui5YIGoTKl+eAHuoJUlwDu+kjc96pkrjcmTrEt0wDc3FTz+YmLztV/zo6akfoLDlXNS124Ct2WpyZHvetdBuGvsBc8e9Qo4J76dnH6a7AmUgeCwwlKdLYO/DeYjfh6+9SozegaYq0f8yXDiT/nnAGPFmvPQxmFRnjktGBS4P1F5eaFPLBFncj3CED1VC4MSobQ=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_509c6da90a8243bacec79826c91a983d\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_2bd340c25b60cb73eb3a0ff01363746f\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>cHgMy0npVaxFM33KNcmBck8tuVw/8S/uaUGwcQyUfjWIX4vIHSn1n89nNIUq7NeVs3lf/RmYzS7VibSjbvUSW7GGIT4jUzJVuFFddhgdn290EyDg0d5bm8E4RTbMGrAz3tL9VPGSAnCqgiuIoi9fMLpiKNjyig5qQmOuBbulHKWRR27VmgHrbPIy2MggqbZ/bgvTvX+6ZBlFtAHtJUtHwyE2/bnVfPB6QJ88sJQ9lMBC6Dsk79UdYrDNE/mCU+8li93RyqWrbQtawU7TLaF7xh0ebLEIh5PQgj9K6dAHy+wD/cGwfzvCcqvgeIrBSOvtlCE9QpLdtoeZmmY6FMGFmQ==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>H5boZq3b1R9MMyd3O6aPrnJAVeLioSKZeDLtS5tS9QTn4EawRPfDjGmxyhkuN8F5VxvRIXLi4nvCHK+1zzKPSWl4svUxxK19WqzPvrePXVpImgILYeMYH5KjaQ673DAQuMJc9GsB2D31AoH5UqUHY23UIsNHADQxtCT5fDc+RvT/Aptef75/LG9C34Sq/arajwxVmJ/VSwaibJF7m7HRC5uYNmaXtjY9oNa4H5kwIpnwySmmf1rFTORBMu/HPl4IvSlRUhOdpXzc6N/deIOsVjKQRAUfKNypAa/onTCnimkHobDqh2y862Uc5jZlwmtsoDmMCxtvqaCVVlFrJBCBN7/QRenQfeZ0L9ThqIYve6BQLMm7RxTuvcktXMTd3Rb1M0bAgtcOcIQaIAaPv8YYxmMZIZ3/ZUwl+PZEha3bkjA=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_701fa69feb87e96d1f5d4d62fbb79b1f\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_81bcc2dc5786ed18a3d89ce0b2ef07d2\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>DSENuoKpYGEle1WZApJLE1Fw3e46RbzYArqd5dOSEqK9ehj5EvGHJoGR/bDWfnVNXilReeKVyAzJFrZMB22laLKIkp5oH4TALcDvawwcb7e3su2/wHXgRCbOWhTxTk3FyWzxbUaTqyXoeHewpUNgNzgQBAs1B3hPBDL0eD8UpTRnvVrfqQNimed1+XqMziL43TY34G7iwE74QcABuvc6C3Az4tC3FZsmd02dXK8rnWfPDWrx3KvAa1pVmNJN2rXtIwvuJ7BnXjSjLpjfarYlkIYxGumzBpVld99adQ3zxjFPZcVtnqytdPXZTNuEeQeml/+VsDuWV6obfoWIHCMC5g==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>8BEfgwdgcfszUB0VFqcZvJtBdY2L40Eydu+coG6faklAzlyBjXQF6B6qaFCaecHtl2n3gFmLyGYpDRXqjV9ZBQe0r6XzLK4faD2tF83/gIGM2Mp8pLbN0jeocHl5rgFns7FYCVADh99wMMXJ5gBWreo7td6fNMT+WB47QLFMRnZ/kHyVSNLLjd8rpU7FH/6uLjRUXU5sRACDnzwLGmPmJDiDGB3Nu24U+cWZK05TGKlDPrJSrQNyUFLvtUFicpwNQIaxjLyUAJEEZLzvlg6skkNsfroZYBcoNyoMYpyV1ADpXLja8EzZtrK7JxrLnUqyW6+rXryaT+XVtpj4cIufvU3kbqE4i1qblTzucpkdyv750OyVTtU1kGjC4sH4B1hPclcEj+cbJaAB3LkYEIdmN4qBu5xIk81GgmtS+KfEpcFne0oGeP7xZ40v33pgi9zn</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_2bdb3f8e8b8412dda6c35b9d016a3b77\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_2ab9d046018dc0fc19894ec12200c2f9\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>BHvyeU90pRwos6J96JPAZOQ31JUlmbpBCmgI/4jgbJ78Fj1ZZedFPNPwX+E/Cs5KKfTFNsomg2E1dHoLkQ2ot+5JIaZ7RG8q+GLpaMonpgu0wiqt7AF+xVz5/UvXLBYbrP1LuUX/+8qpr4ORulh4rqRwfP4ab1sF495nHyuk+vkLSxSPYjNmNaf4voj/ycTGM+9JI/cxkWUymt2NvYb/R9yDzq09vWWDLJ1yhyQrpzN18/83F77fOUAPuxTNLj/fE1uhuqWSWOMrTj65lK+FcYTrysm0TNwTCz+Ky0OgtM98Xe6MxSgmjqqm4n5WThxMwyQvQmDqm/Lk39MR7teGPg==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>wDY/bYRXowk7UuWF4c3aF+YFwh0tRy1lhHomSRcAuLTEJ7mkU6QUSJ+8jLqC2Zm47MkicUMQou4UmdagP4AkDffKHVSmE1nHDIA6hraTtII3qP4I3qQIgpmyY3M2DRNfCjBHT+zzC1oE36uqVyb6eAGqdxmqaR4Q8fxZrHIajYZna3DrjV+QWPEzDsRSNZ39Hk/nhkByEEx0lgC8EwNl+ZS3OKSYfvdZ/LGFVSllk8CuB5c9DJeyWIUdedMpByx+fQFfw5V2fzgBNioPFdNJOwDDDGvZLNs06zIrkv5Wul/7i3KyXBc/jZ6X5nzXCHRjJrbi0TukKpIlAV/0+3VCQZmJuJYqYOMmeW4HPftECJIC0EoylAh8AL1Co5a7FZ8g/fqghLJuhnRF0OBWJSoWezAujn11AeQ7xpAeQPMBKyY=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute></saml2:AttributeStatement><saml2:AuthnStatement AuthnInstant=\"2017-10-25T18:18:19.576Z\"><saml2:AuthnContext><saml2:AuthnContextClassRef>nl:bvn:bankid:1.0:loa2</saml2:AuthnContextClassRef><saml2:AuthenticatingAuthority>BANKNL2Y</saml2:AuthenticatingAuthority></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion></saml2p:Response></awidxma:container>\n    </awidxma:Transaction>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>E54zRb7p1XOQA6zd+3sl6ro6hZEutsivg/eWKaBbVWY=</DigestValue></Reference></SignedInfo><SignatureValue>K+1hcDjuB0AbqhxDDqVupaAvYkHhCfTgLFBN9sHsjwBLr2f7396JCUhdwTE0hGTErdyDncWPJpBOSdxsoyP+pE1QbTFwKA26pwRqMlZieBxaNyehRDgWD2IjVpkU3gg5f++RzGlEoXY/kyNtXyP+cMmwnOQ6MawcAR4gmWebjsUQ1Vg8dhixp7VHS66vkiJKY0B+DI2lTelOHMSR4FYC+nrErYJ86cAgrK+5tmSknn2nxjA7DbBftF8wK8xK2pJtVEUAL7ZgelrjdLcMMM7J7YGZZ5aq8/yqkstfMSZeTpYZVRmkVSV+K31RvzG+v2Sw7pD2DTMI+cHia+/ykgUbWw==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></awidxma:AcquirerStatusRes>`

const transactionResponse = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns3:AcquirerTrxRes xmlns:ns3=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns10=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:ns2=\"http://www.w3.org/2001/04/xmlenc#\" xmlns:ns4=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:ns5=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:ns6=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:ns7=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:ns8=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns9=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <ns3:createDateTimestamp>2017-10-25T12:03:58.983Z</ns3:createDateTimestamp>\n    <ns3:Acquirer>\n        <ns3:acquirerID>0030</ns3:acquirerID>\n    </ns3:Acquirer>\n    <ns3:Issuer>\n        <ns3:issuerAuthenticationURL>https://abnamro-test.bank-request.com/bvn-idx-bankid-rs/consumerAuthenticationSim?hash=%2FZ0i5s5diBp8HS3Lwq72I6ns4TVSnxfzLzfZrEXoMCw%3D</ns3:issuerAuthenticationURL>\n    </ns3:Issuer>\n    <ns3:Transaction>\n        <ns3:transactionID>0030000020094512</ns3:transactionID>\n        <ns3:transactionCreateDateTimestamp>2017-10-25T12:03:58.983Z</ns3:transactionCreateDateTimestamp>\n    </ns3:Transaction>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>rr1eYkX/BXdkUL1YtXYfl1pDZ+dZb49+DjefpdU0qto=</DigestValue></Reference></SignedInfo><SignatureValue>ePOGCXSU8GTtwXPRb+n3Nol4ogikwxJW0zJGeobBNnvCGVoCkoy82svvUcoiMN+MRbS54FaBG9HqcObNpfDZYozR12sfsDizyY8NiKu64rQ7cd0DJ20QuLmy10VeoWuff3vnons/l73rr32sf9mTSM8EELUb4LQczCDEw2G1YzFX1PfMws4cUP8xJIqQKXxU9TjF272dnI15JNsyB25nV9WCtXJ8cdVnI4KFP1AFHfEo+OHq7tGdb6nwAgRiC4R73lm11+89aR7iucKuhQUDNAUbcWozY+pfcZqsAntDr4jv9pSzwHSweHcgHFOyScr1Jjvd7whh1kekfmjmgFfj/w==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></ns3:AcquirerTrxRes>`

const directoryResponse = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns3:DirectoryRes xmlns:ns3=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns10=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:ns2=\"http://www.w3.org/2001/04/xmlenc#\" xmlns:ns4=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:ns5=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:ns6=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:ns7=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:ns8=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns9=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <ns3:createDateTimestamp>2017-10-25T11:54:15.603Z</ns3:createDateTimestamp>\n    <ns3:Acquirer>\n        <ns3:acquirerID>0030</ns3:acquirerID>\n    </ns3:Acquirer>\n    <ns3:Directory>\n        <ns3:directoryDateTimestamp>2016-10-12T06:37:46.000Z</ns3:directoryDateTimestamp>\n        <ns3:Country>\n            <ns3:countryNames>Nederland</ns3:countryNames>\n            <ns3:Issuer>\n                <ns3:issuerID>BANKNL2U</ns3:issuerID>\n                <ns3:issuerName>eTT ValidationService</ns3:issuerName>\n            </ns3:Issuer>\n            <ns3:Issuer>\n                <ns3:issuerID>HKVSNL2A</ns3:issuerID>\n                <ns3:issuerName>HKSVNL2A</ns3:issuerName>\n            </ns3:Issuer>\n            <ns3:Issuer>\n                <ns3:issuerID>BANKNL2Y</ns3:issuerID>\n                <ns3:issuerName>WL Issuer SIM iDIN ABN INT</ns3:issuerName>\n            </ns3:Issuer>\n        </ns3:Country>\n    </ns3:Directory>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>CU95uYIOoaJjHf76KYzhaaVt/84lOnuEG9X/OhJdgUc=</DigestValue></Reference></SignedInfo><SignatureValue>F21sQgxcbW57flZkixCnblYfcM8JlGguemlF56/rMIGRP9pi3BNPCpzFS2i3u4IM2CfjtaoeHfiEs57X664l6YE4XJ+ff4QUlBbNNa1A8Vfoj/v/OJVnL1wTZTOo9anQZurNulwubtifQcHmGbI/rQFk2l6B5uH8s/mPijGe7HXq7Zi9uKpE6Gf5QxyPwNuPGKMt26h8YzAnsyLCUOtkrRzZw+WRqHyLw9EZ9yVMPU5akcvpzmTpK8NL2KnbaDrUanZRFGCJ95YMxRKD4i9CeU7EQyzF3mRUGDGEddE5cHiiqU/TXm/s52+pI+EnoSJQAdY8AqUZrygPO42KEufAMQ==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></ns3:DirectoryRes>`

for (const req of [directoryResponse, transactionResponse, response]) {
  const doc = DOM.parseFromString(req.trim())
  // const signature = xpath(doc, '//*[local-name(.)=\'Signature\' and namespace-uri(.)=\'http://www.w3.org/2000/09/xmldsig#\']').pop()
  const signature = xpath(doc, '//*[local-name(.)=\'Signature\' and namespace-uri(.)=\'http://www.w3.org/2000/09/xmldsig#\']').pop()
  XML.loadSignature(signature)
  const result = XML.checkSignature(req.trim())
  // tslint:disable:no-console
  console.log(result)
  console.log(XML.validationErrors)
  console.log(XML.signatureAlgorithm)
}
