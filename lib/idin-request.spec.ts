import to from 'await-to-ts'
import {
    fetchDirectoryResponse,
    fetchResponse,
    fetchStatusResponse,
    fetchTransactionResponse,
    getDirectoryResponse,
    getStatusResponse,
    getTransactionResponse,
} from './idin-request'

// tslint:disable:max-line-length
const directoryResponseXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns3:DirectoryRes xmlns:ns3=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns10=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:ns2=\"http://www.w3.org/2001/04/xmlenc#\" xmlns:ns4=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:ns5=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:ns6=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:ns7=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:ns8=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns9=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <ns3:createDateTimestamp>2017-10-25T11:54:15.603Z</ns3:createDateTimestamp>\n    <ns3:Acquirer>\n        <ns3:acquirerID>0030</ns3:acquirerID>\n    </ns3:Acquirer>\n    <ns3:Directory>\n        <ns3:directoryDateTimestamp>2016-10-12T06:37:46.000Z</ns3:directoryDateTimestamp>\n        <ns3:Country>\n            <ns3:countryNames>Nederland</ns3:countryNames>\n            <ns3:Issuer>\n                <ns3:issuerID>BANKNL2U</ns3:issuerID>\n                <ns3:issuerName>eTT ValidationService</ns3:issuerName>\n            </ns3:Issuer>\n            <ns3:Issuer>\n                <ns3:issuerID>HKVSNL2A</ns3:issuerID>\n                <ns3:issuerName>HKSVNL2A</ns3:issuerName>\n            </ns3:Issuer>\n            <ns3:Issuer>\n                <ns3:issuerID>BANKNL2Y</ns3:issuerID>\n                <ns3:issuerName>WL Issuer SIM iDIN ABN INT</ns3:issuerName>\n            </ns3:Issuer>\n        </ns3:Country>\n    </ns3:Directory>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>CU95uYIOoaJjHf76KYzhaaVt/84lOnuEG9X/OhJdgUc=</DigestValue></Reference></SignedInfo><SignatureValue>F21sQgxcbW57flZkixCnblYfcM8JlGguemlF56/rMIGRP9pi3BNPCpzFS2i3u4IM2CfjtaoeHfiEs57X664l6YE4XJ+ff4QUlBbNNa1A8Vfoj/v/OJVnL1wTZTOo9anQZurNulwubtifQcHmGbI/rQFk2l6B5uH8s/mPijGe7HXq7Zi9uKpE6Gf5QxyPwNuPGKMt26h8YzAnsyLCUOtkrRzZw+WRqHyLw9EZ9yVMPU5akcvpzmTpK8NL2KnbaDrUanZRFGCJ95YMxRKD4i9CeU7EQyzF3mRUGDGEddE5cHiiqU/TXm/s52+pI+EnoSJQAdY8AqUZrygPO42KEufAMQ==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></ns3:DirectoryRes>`

const transactionResponseXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns3:AcquirerTrxRes xmlns:ns3=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns10=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:ns2=\"http://www.w3.org/2001/04/xmlenc#\" xmlns:ns4=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:ns5=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:ns6=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:ns7=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:ns8=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns9=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <ns3:createDateTimestamp>2017-10-25T12:03:58.983Z</ns3:createDateTimestamp>\n    <ns3:Acquirer>\n        <ns3:acquirerID>0030</ns3:acquirerID>\n    </ns3:Acquirer>\n    <ns3:Issuer>\n        <ns3:issuerAuthenticationURL>https://abnamro-test.bank-request.com/bvn-idx-bankid-rs/consumerAuthenticationSim?hash=%2FZ0i5s5diBp8HS3Lwq72I6ns4TVSnxfzLzfZrEXoMCw%3D</ns3:issuerAuthenticationURL>\n    </ns3:Issuer>\n    <ns3:Transaction>\n        <ns3:transactionID>0030000020094512</ns3:transactionID>\n        <ns3:transactionCreateDateTimestamp>2017-10-25T12:03:58.983Z</ns3:transactionCreateDateTimestamp>\n    </ns3:Transaction>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>rr1eYkX/BXdkUL1YtXYfl1pDZ+dZb49+DjefpdU0qto=</DigestValue></Reference></SignedInfo><SignatureValue>ePOGCXSU8GTtwXPRb+n3Nol4ogikwxJW0zJGeobBNnvCGVoCkoy82svvUcoiMN+MRbS54FaBG9HqcObNpfDZYozR12sfsDizyY8NiKu64rQ7cd0DJ20QuLmy10VeoWuff3vnons/l73rr32sf9mTSM8EELUb4LQczCDEw2G1YzFX1PfMws4cUP8xJIqQKXxU9TjF272dnI15JNsyB25nV9WCtXJ8cdVnI4KFP1AFHfEo+OHq7tGdb6nwAgRiC4R73lm11+89aR7iucKuhQUDNAUbcWozY+pfcZqsAntDr4jv9pSzwHSweHcgHFOyScr1Jjvd7whh1kekfmjmgFfj/w==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></ns3:AcquirerTrxRes>`

const statusResponseXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><awidxma:AcquirerStatusRes xmlns:awidxma=\"http://www.betaalvereniging.nl/iDx/messages/Merchant-Acquirer/1.0.0\" xmlns:awenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:awsamac=\"urn:oasis:names:tc:SAML:2.0:ac\" xmlns:awsamdce=\"urn:oasis:names:tc:SAML:2.0:profiles:attribute:DCE\" xmlns:awsamecp=\"urn:oasis:names:tc:SAML:2.0:profiles:SSO:ecp\" xmlns:awsammeta=\"urn:oasis:names:tc:SAML:2.0:metadata\" xmlns:awvssamlass=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:awvssamlprot=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:awvsxmldsig=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:awvsxmlenc=\"http://www.w3.org/2001/04/xmlenc#\" productID=\"NL:BVN:BankID:1.0\" version=\"1.0.0\">\n    <awidxma:createDateTimestamp>2017-10-26T17:17:58.244Z</awidxma:createDateTimestamp>\n    <awidxma:Acquirer>\n        <awidxma:acquirerID>0030</awidxma:acquirerID>\n    </awidxma:Acquirer>\n    <awidxma:Transaction>\n        <awidxma:transactionID>0030000020097259</awidxma:transactionID>\n        <awidxma:status>Success</awidxma:status>\n        <awidxma:statusDateTimestamp>2017-10-26T17:17:58.090Z</awidxma:statusDateTimestamp>\n        <awidxma:container><saml2p:Response xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"RES-0030000020097259\" InResponseTo=\"BLQsuccesHIO100OIHtest\" IssueInstant=\"2017-10-26T17:17:58.127Z\" Version=\"2.0\"><saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">0030</saml2:Issuer><saml2p:Status><saml2p:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"><saml2p:StatusCode Value=\"urn:nl:bvn:bankid:1.0:status:Success\"/></saml2p:StatusCode></saml2p:Status><saml2:Assertion xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" ID=\"_a75adf55-01d7-40cc-929f\" IssueInstant=\"2017-10-26T17:17:58.128Z\" Version=\"2.0\"><saml2:Issuer>BANKNL2Y</saml2:Issuer><ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><ds:Reference URI=\"#_a75adf55-01d7-40cc-929f\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"xsd\"/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ds:DigestValue>DjldYBbBCwi7vBAiFqZhADmPTIE11JdPQL89v3O9LRM=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>eudiDLB2A6eRgb/8N64oIwqVqTHoFQP8howCgdSaqM3sbSvgE+xwr6lDQ9NOp8nPewi/KMwWT0jO/ExjpO9e6XtqpJvZZsntTDFBKjjEXDtTavr2FNn31Kf+IZcyfUBeXUisCQfUH5qq2UbByzgHJupM4g5c+sbpqhKuGItr1OxqeXEMqyvBpwgwIXmOEBTJE8ZubpEn8FwshCWh9p00Q2+v37NuSyBIAG4HN8F8KNwbvBIeWs8uuxsBlfpeJgEPjRnapy+OZo4gA18Fvkzf8iw8/N7cQ91TYjdm1bNs57H1QdR5ChvrzEi1HeoklF8aSlxzA5bNQHIIL6+uQ5nXsg==</ds:SignatureValue><ds:KeyInfo><ds:X509Data><ds:X509Certificate>MIIDbzCCAlegAwIBAgIEeCuDtTANBgkqhkiG9w0BAQsFADBoMQswCQYDVQQGEwJERTEMMAoGA1UECBMDTlJXMQ8wDQYDVQQHEwZBYWNoZW4xEjAQBgNVBAoTCVdvcmxkbGluZTESMBAGA1UECxMJV29ybGRsaW5lMRIwEAYDVQQDEwlXb3JsZGxpbmUwHhcNMTQwNzA4MTQwNDU1WhcNMTkwNzA3MTQwNDU1WjBoMQswCQYDVQQGEwJERTEMMAoGA1UECBMDTlJXMQ8wDQYDVQQHEwZBYWNoZW4xEjAQBgNVBAoTCVdvcmxkbGluZTESMBAGA1UECxMJV29ybGRsaW5lMRIwEAYDVQQDEwlXb3JsZGxpbmUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCmCC1wb07Zza4csVSMWJNhkZttvAjNYFPtlsHI6aZdLHy04BMx27lXFYexs8ZhNtyhniIaB8O3OV1cP03cI3tWa2Q55eX1BysvmDnTYMprHiFktYvSuXdN1PFa8NNswNSLMsgja3Tp+SrHYka0MtsgVM79Rk16ExvSaGmYO0OV5dx666yKVUCBV/lU/8tyIhHQAdTM4KGdWggfPbcI/KkJeSk3YPHY1LbmdpdGDS8UJcBwuOw3JII8cXj3oDPGQWuXVfKVE2iS9IiEjAipTlfvrA1yZqwfq6PcUSrVEWa++kr/zTzSUAwlIHXL8OpLzi0cGRgdtVEjcvO1DkUuQrdBAgMBAAGjITAfMB0GA1UdDgQWBBQfp6FTr4Fw6bVeVGY0XvVtEsEu6DANBgkqhkiG9w0BAQsFAAOCAQEAFrD2fcNCyKM346xYRJ84PDaLA2MagOy9pC0j18iFGsR+LZpALkYQQweM2Xu9IWs+IJdTC6gnuQzCedAAFF+ovXs5r0bwwG7cmtOfdYQh0tjDk515MbVeVSXSnROJLPJVjcNeeHfdSAfKhJE3bmDtfVsPVtkjbuh5waisKbswb53+aM63PgNHdHt9X5la0HhY1Ggdxd2UicSl5+6ffEmSMQ9jTh4JcUMMvhi4bZeVM4renRWjF5v8VITl6lLZy3lKDzip5Mw8g8mtaj1GsY55/Q60vFSvLJztwuQw249zImAZ4JAINmrIPfpDT6wnwnprRXwgvE4o3AAFYCyJuHTZmg==</ds:X509Certificate></ds:X509Data></ds:KeyInfo></ds:Signature><saml2:Subject><saml2:EncryptedID><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_9274a54b4cfd8f6762d2fb269a60aa17\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_e97862938ff0ead01088e5aab92d67ef\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>g/FgmxqQbskre270qxgDPlMPjinSPpyKyVZy9Wjn+9D4XqVoVPiKi4zs6zJpbZ0rb54tXeKyPfkxwLfgAS8j/rS+VGHP9RPtZ8kmI/IYRmlOJ2QZUVoRHssDODnoxpg+ho0af070Tu9BgohiwAgmzUF/xZV4wV5B0K85EK6WZPwexCFJw1WFl1ktAwJpUYkkpT/xuzuOM6+sHgypRnhefw0+eHyvT38BH2oPm7r5mtdYxsM/xfpx0uxTuSu+VfuDuLJlJRLgejUqJgdmu/hWTa9nSXB+f28IAs3O5PjG4FrIjl0duawT1+1ZOy0+yJhyY7ZUm3ju4+dnZ+3hpFQpig==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>rC7DENxE34iJRo8V/4UMmHaoQSxd/lvlgyrbA4yG8X9uUWU+AYLy5p6i7SEVILugl18IcGz7cp9hQU9G+/Bm2VuK1HTqUhWNtdoRCmDWOMtL60DDfzjQ94mQdyaVS+IaZ6Jpu2fYsfIzDP8kH/fR4AdmyrQn6PI8koiHDvv7c4p7a4/rpivSWDIxpqp9+YVf7pZWWTTteUxDolcz7haLvJjaLEohapHCIX/lvYjvQYgfwpMCn4LNpACxHFRGGC9+</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedID></saml2:Subject><saml2:Conditions NotBefore=\"2017-10-26T17:17:58.127Z\" NotOnOrAfter=\"2017-10-26T17:18:28.127Z\"><saml2:AudienceRestriction><saml2:Audience>WL Validation Srv</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement><saml2:Attribute Name=\"urn:nl:bvn:bankid:1.0:bankid.deliveredserviceid\"><saml2:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xsd:string\">21968</saml2:AttributeValue></saml2:Attribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_1984f70c485f4d1aa3ae01a9a8a177a0\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_9e9b7bdf73423339a73188142ee44d1c\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>JL40DqmaKywuupzVIs5xboEfJf3P2H/s+hZ21ai+VTXHNdBcW3t4MJXqqf7wi6S51KHJeDCiM6nB4eBGiBImxvr4P1Vz6WIDLTQe7snCdL+VF7Ti4ZYhV3iDXbMxsGJ2UuAVIf6PsN/w1NMPSQp+15AQBD8wNWtGTkRqC4+zitjXi+2wFG++cYf9427cMyei2slZqz1rl3AdM/1xTlgzBiGGeqoZ4XgrVCEcloxmEADn07BSRaOyxu8fII80x9ovBCYkwWGfEXj2Sp8ES6hp5a3/mFE8p28ivO2+SnvUpdoNRiEB23LaKdMWeM5cLQ6vOktR40yCKcjR1kckzKhqHg==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>pgQwSUmYgm9b8dxNJAjvSExXEUm4REjy6p3vkTpDL4VXKNhYWQtDcrs/aziMWzgE6BhRfKhvs2v/MZaQM8TIdvazwHfkjNzz2j/3aDlH0fSg3IjIgO/rfMVEZ8LLSqD9ePASTgoe6CzaOyeDkCNje1JLI6eJQDSFLiWgA/rkhSsHhKRjeF+JOVbb2/V7CUVVfREfKjnGhtELW1Up6o+ZIt/r3zDSFilBZWnhu1yJ7DxRsNM3tS2YlZPtvoxHys9e1nJ//0hoxSQWJrGoFpCLIZ7QWEJfL5REDt8+COGUCFFwOIhKf7Wy1l4/eK0jWk4PXHUAaJcJwFWHyk/bbMZU8Cz24LTex+sY0quU/RJ6w/qMYfXUkVsHVNx52mRfHnG8KxBOquEF9h3AlJL3cSPHmJh411KK8KlbCFVPLA2XXDQN5M/zasrTySWdTbfpPD1L</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_2cba51b4b7d25aae1058524fa65e2724\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_345d49638fe1ad71128943f5a357b5f7\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>jnQEKsHjVcRYyePCH9I8kVnQO44/0bStwvUKMfdzt8qhkbqZJy/qIfvNKpbD4O+zXuRB97mKVTkPejAJGsIm4sjluu9T1iAC1UmSlIxNJuxZuhmxTlDCs1EXaP2OXm4nEbrM2oPxpRihfuoKd5RWmJUbMIL7/W+7OfaAqBvYqcODQv3IDcs2Z6zpfZ4cS+vHOYRAu0la6PZFo6w5vLshwOP2H1ypDA5o7PDHt8DfPR6+n2kxMRoN1/mqh/AWGaCVSmh6g/aK8giRFs9BF3PBVMMajFWouKMFeSMiA21B1RZoC6FiNrsEQqrECVfMrRt3JefC6s9tkuPpvTAgokL1/Q==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>HYo+vhWf9K0fUvP7DDWbrnk506QIsvlvvbVukXuuFKJ5vWG5IIp7qsqu/BVhxUMHqnjDUya3LEF5DLh/JFzjYmLc8z1gbD1Pgz10tdmoMRJnifalxru0gCBIkKudA5AxIf968qkbPIy+EuV0Nt00sYhZvCRN3K+eO+7rfAaFlKZLSQoo9yZ9Ed8xmGyz39apo77l6cwY6asMIgy/omHOyj13BDiPY46kbAnq9Kji3e7c9dJ1yxbtJO1cuvi1ymZEaHqpmz0YTVDcQLpYkTipRhL0dRJcr930N9wcg7FS0euItjLuLYKBJoHL4FhYcE+R36r51yi0A9V9scRTpQWsrdXSh4lr0Ym2DS4XWGN0IjDViY6tUVIR3dVDhpnMIzE1KlnQonMx/Mtg8b1fnMUlUgAJXpHxDgcG2BcgmJxd1a1wPdOs+OqBSVSfsUlqC7wNk7IVfIITKYDF5E+9aOTpFA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_1be56ac782818182d5a5147bc74114b7\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_ef38913461278a505ba38e6601de9eb6\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>TROHxjJtOKqzf9yWNIuZIHSxhwrKLgzKSo/8alRSuyHm6eCKiNYBuFiO2ZlY2ajZo0yTT2pq4UCQqkQlmV6+kf5ojCGAHCj7kZXuIQSGrIBW2K57PQhv7EomjxjJky98beDwlX7v0TFmvBGLDbbfDFZ30y+O5DbHYusU1COlCdg5Ku/ozP0/W2QQuAEOjBPvGUNqK9YHGVbbElCnUyW9pFSCO7n1U/c9AsKEdZegycm/7TySqJJ2/aySSy0091nx+fcJo1L8I6Irf59fdCw5mihlxgw5xCkOre95Xl6n0jUwQHN7Tkr0PIdCngDB0a+QJpRgMmnvRxZOhSOKYdR1kw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>pTQWmtPuYeBtn/U15mriTVYc0QKCzFOMpON19O3LsC6YB2wOz1wQaRJauziDWme5INjWMHfFYbZ97SRhzknh2ETRuaJJMdChXYj2b6tTz11Fe0bzvBDFl7Q3t4KzPfWoxtr3mvF9rG89cnB3Zo016tFxEENsauDKzpA9O1F7t0YfcP+oW4SbK5fCUXROzta0q5fCrIrrFRXBk6Ww3YHTHWDkFmgvFPgjqryV2ajbg4QTP/lfm9cJt3KxO4UrbkloB5LpFFCm1buBUZfO9CIP+OOvMPEY/cnoyoxEFGyWcjHBBeI2K3GKf1AFDDLudU2Es+g5JDtt/edXnnZ5kAyNuvnqi3yFBocSvZg+WuaahSyk3poOKhQ6Zcck8NCNjnsZoqxGSVtonzW093Jc7UTpLDAKIaPyTMFm6FaeMBlkxXGv0umPq8aeiiCsDISU+NWn</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_1108504dc963d366fafc1a39cfbf995d\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_79c8a4b395cc0256bbc1a8d6a9995ebe\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>iqgZ2e9FM7sVG7laUnD2WFrFKK1B0MRYB98keqc2hlV+5FkFGb1Soof9lOalFEik5zwaxRPzGsflHYJUxnmMEyscX2WEr154+1zdnO+R2/9IXxVDeHjyrxvOgmlFOCMmRWqmOoUeSp1LPhdEvTQKNhd5mVH3TUFA+juU5xzpOtZQPripKak1DThDKIHzhFgLBnUxs/gE+vWMMAocarxGVCDL0pqk9X39aKxMkQkS00J5dSc2eN4ieM6SKdKAKKPDWHNu6iOWUX2R1ktcsrlszGdeo/R5d1SIGxGAw4aPAYECqxS2TYUonAMxKLDwohyPPR1NS2KXfO3fkbE9py4u8w==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>Q34weUbtwmkwjx83q8Or1cokzGjrlCRaRL3HmqX9x43czz53cA8gd+cbVpXhZJu9G3mLER3HjePEd5cBFso+0+O/z8+DIL9Xf8aCvLcnMzLDDAkbXqt+yiaAP1upBXL4xqCeHISwiVnH7anRaSfGgpwsd8974yoUZwhCLJn9CS1qZYYFfIeOYjk1/OnIBAB6a3w1cCYAUUzYRroP4Y9hDx0GRffgQXSK7NfiUIcT++ilk0VAVg54Zcz/ixypi4wlmbUySpMl/wfg0qLmmtfdRuHWN8ZqC6b2pxkeFSq2sQQ9pY0nAe6JqMq7ZEddzPE2iyFNrrajn8t9Y0AOUjG6NpqBrE3jnLRt0CxcoEhHwV7Oc0R1fz2r+fV4mo0LlSybIeW29XxwCOKEMcYf81VTT1yevo/qPKn2uHSNDPIf6eysGlm1phWBKYnCz8jzIc3Q</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_f7c3497c1070d0de4e5a9a9d943d7b32\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_be7e07489876ee93d4cebab8f64c86fc\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>oWgu/KlCPvNhtCwSCZVnjLwH04eX6h19L85iqpKfd6aB89aVP7fyrlMmRp0iW5ScMhz/4ggKgZzxjU8RTzdUJKMLJH2DrvAROmPhsPeVFepnKRmpCaobTkUjXT14CSW2VGXBNMizrzJt+XcQI8IwpLJ18SbmHw9lSH8DHnnVoEwveM8z9Ou0S/OcJ47q95FhIMG+Uy9yUjRWBvrsEUAc0Vq8CxlIkeOOXw1Wn/l0ANGAe8bz5pDpFx3sxL+MCiPPFaxrgbA+lW9sSOs7mkIKV6zZfsu8/AqGp+6SRq/90hBbZG58unS+vTGX2/Io+GlV+vNyHuX/ISdQEqhukVvrzw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>TNY+FO9+vGDtIz8EXrkfnvwyJns3V8W96KkTN4u77T+9V6gtPxH98r7JkarNSb6dipBBg5P4nzZDk7gztN7BxvYTFaIGo2W0XZWH46N470BY9n94uHBeNuCv41qp9y0zjonwbgtnOqyh/MRBxk+vcvgNvttJT6312F2+/7IzDdjnjgte9ETo6QSO6a1XKxWNkCK3h+H3q6Ql9dRV4pbIAhiDpkP5i2MJSlFuuEqONrXjTv1SQ8bDqHpJmOwMxLUK9S/L5ltzAqUrTtWtrrTnceLJQPqqZGPYiPFyvflVr4p7Q2WMqjAuWcqxPX/bRV0goU4R0Pha4+q7EE4wpmFt9mmKJ3C3Z2AWqAqjUS3hUePFW0e5TyHPVE427hMwoV/c5+iIr/fNQIjBDBp82cSkGYWmsBrTL3pnhxOYOHSXulNvzF0ks4KfbyKK3ARTsz1u</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_c4f5ba77559561046bbb73b1a6d3cee7\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_ebe372c4ce029ca7f4c40991f5add1c6\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>Tk9oT3nzdP8SLhYHABBTkUfFadEtWGxjNjFjSDFcCXMCXNAfkHOYJ8XzgPBNQUF9I/X+b4Di/KzBM9U3DUMsIDMFEf6xKo3v3no7+EclFp/PU/+Q/MSVUgjbQZrSZ3F2WDbtu2ZZ/MpNJr9isYE4l5Pxp/f3TM3bNne7I8yfX++KNQKBL4Wp3Gl57Rd5EC1syDp9+/cmEUu21qhOssK9eUhtjgqYDRO+b0S+6i8NbH5/JxBeglubOJexrAPfqgZ1GK5ycVz5+JYyUx3zQvaA7jaA4+CoL8ePgYlNGMpxzjkEcjJnX7AI8NSgV849+HOgtjGFCYiOlv7ufRnbQ591Tw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>e80n0Ms5M9rHKDtPRBz5HY0Z9jBllVbhf6OQW5cZJiZrytV5qfRnFCctY59nqxFTzHK3m0pSHK1MKopUTtWcJOUCszmhOrfnrXmxFhoHMMf5LUVzkFFMiAx0y8MeYZSbuaw2bu8U1Z83B3KYPTRdMspNae2tWNc04eAns0zG4zd38JUQYzKTllgztNTkKvQxrIvjzAA3f4EZ52ZAKTl9/EhHsq2ly5oJ8qzA4nlGv9EfLn7RZ5OURvMY5wui3Uwuh3wGFv1EotPiC3OaqJCJBulYL6jg1kWXPj5NS19ZlSWIWtADtdEgTSRCGvRdgb1c/lfrsxVauN+OtPodrzpyAlMFLC7HwcgeiT+uQReEWVwXT0VI6Ro++57keAC+fACoBPNoHGResWkpvT7GLFKgnU5NShuG51pWRzDFXL/4Y4ToA2W3Qrha2rZeW3rgGju7</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_f40f95894dc1ccfbf0b9abf0dcfaf6d9\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_0fcd1de3edf7cd84b4bae8d7d538880f\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>k+eG76SVwROljU3q6Eq3j37iQAfcS5kAp5FrMKEOQWyQdaaAvRU58H++SFbtYM85vrgpW3cGguv1u2NxWWijsJReZnGI4tbLwSJ6SuimxRJytJG7HQd40mEzd8kLpBiGFSyBmVYjCyJ5uCJOIBx3Ee5uxAiTlCpPtM0URHnyIsJtqYXv+/3Cq1vGclAnTbH3Wok26XTmXbMFlXN4/vkVmHt+8j+4IYL/FSoiwkM1vH2PJVxF+zksFHqqPG7ZDaszthDEvQnQL1+U+fePQWnKejZU9pS0ZaqG+t45tkvf5c5sVEf6Ly/Hx5ROjoMKlVjb0XIGn2XxBfwW9CsGSMl9PA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>gXaFp6nPNblVL/rCmUSxCHGsWkeBrw3OvZanOelJDutS4q0r+YibBlIFCbZ7S8jlp4B/vDQ93YragWXLTwhGmkndlsBc5lNlPBbDSGdLUHyqtgo9ngWT9GR07YpAeGTGzDaPdsPHo7o6gauAKOPMs24Vc/YocpS4eQkV9D2Ipry+C0MRlU5cJP+KWvl28X1a2z6RaJC1U7PpO1Iffirssurs5Ee3WUGTPzs9WvNGxjXDqHx+Euf/KXinOFA8oqP1NEH6f6AI97Vd00JC1NskZZuUTdOIJAKHNvCGDPm8Jk0BMrf8AqjJJU8sgV4zFj5EIXl+rsYOhOEARU6OMogDULRZyeT6L+vesxrjiFW4yijeCnbVILDBlFL4dNSfAFBFgIu+8hJRGF3koRCGAXkfvBVKlmPqPaXk8ECoTeCyUJo=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_b5f7266ea4b782ddce0ed8d19783db8f\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_b7137c4c3bcf7163b6879a8d187303f0\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>O5aWRePoi6KL2Fgn+zviGOo3lD7wSTUeRCwgy5HRSqLBHVtv8XiCH9JoPiloGsfBL7BusY8+g+LurLq9XIiiHT5RAkT2Oh4w5b23Mg5kR9XAX1/Zz3rGamm+PisnA8EGnnT6o63sKFhO5biliwSv2koyOTUYSuVi5C+S0NEMDN5K7OLmP7twy5PfjHALscLLIk4bNHYrvZP5eynSd1goncI8QTNbIk1oPz0r8eNokFSnjzlfobytuoIFTfG3CATZkAfvbJknCv7dD0XRyp60MZde9ew/m4IZ2CduHuxiUaLGLjWmvdOXojz+atd0WT882fXxRBe++AvLMrGCXzhi4A==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>xT/NfbXedbY9QN5ZU67AySV5tXJre172DHTmFxuiy9e/KBmQPu5eCfmuUpTdmgZEIX6q6Mg9v1WGHv6sVGZJz+GIgDQV9kbDZbpse5Je4oYdL5OjjwQ4I2pnJDoxuKuuIAj8u32vLL/PQJQpng0LSi7hgOwgEZqSl1TInTfcJEwiDEOdYbCBHG9rc0H4e17FXMiVBnOsy/jNEESK3PrI6VqNdeF3E9+Kehu6HXXEZAdh/tmfg2xfJRp7mxTE9pDo1Ob1Aw123t3+JYE4LZaJR/D5HY20h0YHv1fRAVseRxl00v6/UvBFfcaOVJZhrWkgK/+u3SQQ4YwU0dr098Y26oCDUTG0hELC0LL+TP+MTYfGz6VMN93dF8P5+up+yhCz8a/pTRcHwRzSzenVy70DWRnvj2fkQoQ0GaaSnxyWa070sCiWofbhiWPrOt+jINPO</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_9e0b81cc257234c5d4b4b1cd06748f60\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_1a5ec775dea9b0ab8fb69d4f667f4cfc\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>GEeC35xFoYnEH9hfGC7ygoZBF+HPODKbf1Cz7H/4VmfzmerqBcgrxwZzWW0LoiQkyfL4F0EGLNEqwgws8gJ/5XRrLgHtiTudDJIF7amTqBoetKiG+a3VJ1Kosx1Y+FhY/56q6CpSp30BymgWjtpI9L50dxH3UHPIOjJOTSGGu6lOWul9/i3/+q+K3QWmgo4eUEdubhMtjo8MgVqlAqx15h4as4WoMqONR1IKNlp3A2vFOlmyfML9VS7DUPDWNUchQ+ZJIvC63oz2YLquAVwV2IGqqqqyoT/4MlZcmioCGlcms37wsQvggGuBxfbuAkglvG9gapXq/y3NQPelw0E4lQ==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>275KbHH+VaGWzIjvUgkhxjI2sWoiKHsQb3vthiinVCkL0mPjVJzBGA9czUVTHmUxoK+x1SOO0zJ8q9Q+lSSCIwCUSpAhloaj4oS997k2MzjgAyRHGAHcxKOb4Wv6zKYyw9IvM2D0sUgdbUqmiM05ajkEqSYgh1CDevpDZ7/MMt4BmzlIhizW8Bz6a1LmuOCaxnDjbxtbb2muY9iBbkntyKoSvn1ENmkEWCGiSt/IUsqSzIvCSiJ8Hldt9VgbXF9JRkMbNVhCLh7A5bpKlutk5MUu1vcKJmyDo4/WEzhmq8uUk8G8hIuO0zYL1SlUXDmps8FNT9ytnp2LngVYjXIpr75DeOK7B7x9j7YA4wmVRoNYHKNBpKPro/veTCSF2ZHTP1NgIUXdpMzmylyznGVNRpJ/MGV7kFZPGy89HrgvWl4=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_a846f8f8af7d4f1a496e217081444478\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_3fc4131f9dd0186488f31c43c3d56d11\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>HBMLKF5gUh0gJKW+F1sX0qBgmIG8G+zBw59Wd8armSoEshXAfiJ/8P218TjKbadgTaMrSkZ0igLiHuSXoZ/hsOh4t5aDpsN9PyPVsAipPuPwg/49PfIEnlSDSDe51FMR5SEqR24JqVys59RDP8UClkxdWXj2tjTZ/8AUmSQ275T3B5PTXuRsAVeCv/7c3TtizSCeNhjeJekjYPRXSPmrHbqu8S/LmavUcsw0exxFeMBQMCHHtiEmQ/cSeKv1yue/iw3k27uVJ/NL0twSsk1MKjn/ixQokMgLActNRuUXsTzg0v05yZsNlq+bA/f2dKBdKMJV2mEDdvs5mBhoAYWwrg==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>7p1IqBukapJDlDFrifGVB3KAPvFeMkiupM3W/h0x5Mc+yqXfuUAuF0rWoY32FOCxjuEeakUxb5tUp4ltk6yrlm9rr6lhNXh16QwWWtfaFhAy+LUL73eplyQ1bYUZ0M/NCCTnA2OLtQrYfyMSXQSuCMzmUZTqUJe3RrUZbXjWMi9MyYwdZSsF5EF7qSQwo34bvxEBiv2766bXWyKPuq/psTa+s67MQOZ4G15K7D2liM0UsxW20YXvPSYc6VP0DiP84v9SnYU1WRMyC4Ic+Ls5EGDBg2Var/xfsTdidNvsJW5lCu+eN7t7MVdsbPxuQiGgJwj1JAp/Ko6jcSMd1JotWMV2Bfanyk4f3WHiaDqaLn4jqsaAK2cYGNEQ1ThBODFL3/Hfrqvs1+T1wN1CmhOTeVq5OhXlRv5LtHz6xkh+/Uak/QdmeiLDcM+JL/fBNiHA</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_9d2daaf34f78dd9b15d85d67ec90c804\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_d5eb7b9f6b02c9ede0a65037fa4be2d6\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>pOFewgCWMeZHDk10sfhUSZz4NLpxl8bdF1iSdbJzhUP1hBWB/Bsgi2HjzT046IatzBwG88WD17OT76vMx40uCJcyVUuOK3asF5qWpx/vNao27r4bfxlt8zVFn0fAO7YirptiBflvqzL6lSQRrPkV887VfHJs2O8KMI2ukPwIG6Ok2KaFSo8T651vh49rSoh94mO96+AJB0k0kiyAddg7L2jT5PICNiQJISyQUk1uUGCsT+bjdsJXC97YHd39MplVpGbgtDRKP4pMDybkDCjcNEfI68zuF9IAlei3OdlRLDe9+JFzNN12rnKbAAoMqRXlqUWEi7r5IylzjeUYUsN3wA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>R0nsz9TjfnlQEGx//yfczxy0ESXB1708abA9C9LKGotszpMAC2oeFRuLy5w+bemthBW1A2Gy1LMRgoZ+yHsCGQO3OAFqkZZAXqxGor192I9nNDhLLGwOaZokeTCYNgGdUPQW0YJNZmfZoXN4a1fb3rmL/1uyFPWaePQxoOcWpeoxtJFMwnoReRhi8xtDsOq9l6FWO5ejGjW6NCk0w41vgVdZRqfuts8HUhAxHMvEu9azK8+IlFyT8N4lV6TNdw5KLuAhOk9WTupkyHzllTcq+sr3Ei/85LalxJb2ak9+19K+xms7Y/RUP3oY+yVVKQnHzpk3AkCReqfZrYRn9gD7zhd6rkzbEh9Zw2CBFFnzMeJknoI3qnYclkR0p8qUPwws3Evj5jNAWioIvtMkWzRNnogxBo3XyOm4cBJKdtQ6gRw=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_5adb55424fc119a7880ba71a308b0622\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_419833085f70288c28c00a2edd0cbd55\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>VL/uH/Pdp+QYSFgheYmTlbC43HzfIOeumxrRIoBsC+moCb6s0X6tHTiq482TFlLjjJPWt3PJIW1Vt+j3lwvhwkcWHWtYPLCPH1aqkzqcSmXLg3LMU1mTQKTzu8DXosqczp2uwBzoosFAo2JSCSWYpfnI0TUcXODN+jVVustpkG8q5gPfwaI2w+XUkSO91WOrD8iKldAFDkQJAIaLZJYAf/B5K8z9mJcX1GS0juBV2XRc+FZDxnrQfozHMtfpeRR9Gf7YloA9U3qi9IDyi7RZqmcCV5CFFWIpdgygldWKTL3VlDaSJ9BruXrpaJuqLtl4Qr4+79MVIHRPZyFogkhzdA==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>ygPeO0IFxgA6uZgqmOabiHrxGu83Ij1hE009SZXy3Y70rWL3psfLjGcEuv/CaR6o9O/q7jygsJG3WG7Un3eR6zGKjo8/calV0+iSwqwSztYHTs7iLLyuM4ncy85adplysRPoVbl/Xs2iwTuGlpgTyyUnYVjDMWAtlkBAWQnO5VZdVeSfCQ2Oirkh6JBA3gmTio6bflgz5i0N4WSJjGY28RXgNiWSSpaMsiA0P94DEXjlnKJUc6YsyHIcU+pfb+qE9+EywmCmgKMAiy4eCLq2z8FAtYZi7hlmOlZjOe4MSfkS++i77a10oY7qElfKflqc+Bt0FsxvzvhHZM6yYCNEW6R2PdSr/VTr7usxfBC7S4wsHXDTuUf9kzhfkyAFC2AA4PpnYa8DYYSCnPswbLu0zCq7COYsSLuZeIrhhIohI0k=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_e45cebdc77523f26bd53bd8138bc3af4\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_c207a4ded6f09432ae455a497cbf8113\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>Z6mb1tWoCtCfLTZ5PhNifv81q+0wd4qoMuH2yeDEcjCYhgsv9Tqcq/J/Rp5ngk1/tAPQjE5cnqYtXsTOZSfObKCjju9fR9cH9/X1M3+Fak8x5Nuao0onDg9GNGrMQLzyBNFMlrvF2j+u5DymUhxvJojYhtHJtJ127j9XaaQexPd/o7CdE4Q1gfKZMaPS8XUG9UyBPt8rxWTb7xxL21lfIk97ptMIr5kWvs2rzjw2b7ENCRzuJUxkXxClxR+1FnJeALI3fH9AhbTYsEL+1/BJ3uw60lEwLN/X4zGyna5x3B98yRwgL0AkQ/ZYKB2KMe0sNZ0yJiIRMndTTOugVpO0Cw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>+mnoW574Vf9MQ8KPKZc/8vqS5cWN/HYSo/nbIeCGOlIhN0C2vriZqs3zjhg2nWMrPoYqyN5UmDQa7QzSK3cpEZCAl4Tin9kSHLGWZ0vBOm/HgfKKw3HezqeNCGsyvTIo9Lo3mBqt3nrGSNYCjNSovybvQ0EDUblhZylhAnw0t+AkSebn1dctIs8HYih48b54kkFCrmCQF04k31RGlBWlrvWaHlqTeCwu5jZjdUpTL4hjXNSpPUS+X+ihulyU82qThjDc2nPH+T/5Vl2wVwmDdyIwf5YXmtP6cc1T2umaEh9BX+Vnf8opL7MU+gDmZJZ5xpiD9Gbh/vvSMI1YewNIJWks6gd/bWwQmTFGNQ+VlOQoyWpOlj5gRET0s9W8zp7o6WCOXfMYdBqnhU6yY5XtJvWKJGoMtiSPwqTnC/DF/8LezQm2o5dR7+U5NYB3ETJh</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute><saml2:EncryptedAttribute><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"_ae62d0ad6fa61f13835dc2a6a37bbb44\" Type=\"http://www.w3.org/2001/04/xmlenc#Element\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\"/><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><xenc:EncryptedKey Id=\"_65099eb90fc87a874c5370e52e555b88\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\"><ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/></xenc:EncryptionMethod><xenc:CipherData><xenc:CipherValue>Zrpf6W6GGhETXln/jMg+h0mo+cXSPQDzgo4cn1WL4uWbWl0FkmQrPMA/FLeDtBJwQXW/85d2y14LT1LnjJKy1I0ipJ4ZxltLAMgtJ/4OM9O+hjftTUsg0X76DjFdg01ruFWHhgJ6lxMda6Ub2bPhqMQ9bHHjNXZg5QMnN/2ij3jjSfhT13fngDoKNSr8yrqMn40CgW3s8AqT9CDhxRsqpHABNIWdwbvGG3B82bF1ZDRfWabBKbKRlVFkGHeP2ZRv/FXCvSF43YZHJQhldblcXPUpv3n8LaETjf8lAWXdcsJ4al0my+Av6+fvXix5pkDG+TrSx8a4OSYwx1bKDG/MHw==</xenc:CipherValue></xenc:CipherData></xenc:EncryptedKey></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>BcnHpGB9t6Z2AZxefpFSV/fAaNYdpvhTweXXY6dirLqYk/ZZ3PBRGaHNR7MAayNtVIZgLWD6KpOa+/NkChMajY8DYH1Rxmb7f5H6xpBcC2aI9e0prZ3+vuILPjrBpYWAJLVYuB/B/n7NnOpyGTh66uxKmKBEA7rQHI/i/tCI2bJqBdvlsHUZke4c+enhTvWKE/kzBvso6Ux3HAkE8cPW1D1bPX31ll1fn36ijuo+DgxiiTJNXXNdCv31nIEfHENljPWwZhS4zx2wj2d4pQiclD0o2eEY1S/moIZfOrR7EZ2RwSBbzxEySF2Y/7fxBQIDh+95M1F5SgjbUZgV7G/vKGU7OAmYu5Zo6OMfiucecRkvb7U6g+h9ZIcS0WXnWyM8/WqOdCVhnNvjBk1yHgGMc4zIBqL2CIYDpAQz1wCevyw=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></saml2:EncryptedAttribute></saml2:AttributeStatement><saml2:AuthnStatement AuthnInstant=\"2017-10-26T17:17:58.135Z\"><saml2:AuthnContext><saml2:AuthnContextClassRef>nl:bvn:bankid:1.0:loa2</saml2:AuthnContextClassRef><saml2:AuthenticatingAuthority>BANKNL2Y</saml2:AuthenticatingAuthority></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion></saml2p:Response></awidxma:container>\n    </awidxma:Transaction>\n<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><DigestValue>T5x7wNbXINGqL2wfnSy2U/USMcpgYVAWGhStJtuNGkY=</DigestValue></Reference></SignedInfo><SignatureValue>B8frDGqmFAyiKOXq0xUpsGOAVrua4F6jrVsUyVRNzB2QMaYGuuklNrjDhNVuyvYmLUcItYjgtaSTNhHewapZqTyVUOmrKDKYPu8a9N2En6IpyaEc1xSY1cfbV+0rQ0mNJa4qJlCDrlKzmkhLX7C53gWOTCBcOYeOK9J7nGKPRl7FBeXwWJKYj7ENfSljQ2Cjsut4Xv3rnQ1YeskuKlcQ6eLXwAph+MnPmO/ye0TOAc7aKAAKWyzwpq208CQB3TAPCvAQZUyncuGl3c6AtSYU0whLjiRdarQrSJbNOhsM9XZOG7eA9nbxJ1qmYvKN5KkC0DghudQ/TeSZv/fd+6hIGA==</SignatureValue><KeyInfo><KeyName>5ef3776d972e9cdf45689eb0c316e13c1ece412b</KeyName></KeyInfo></Signature></awidxma:AcquirerStatusRes>`

describe('idin request', () => {
  it('should fail if not ROUNTING_ENDPOINT', async () => {
    const [err, res] = await to(fetchResponse('xxx', null as any))
    expect(res).toBeFalsy()
    expect(err).toBeTruthy()
    expect(err.message).toBe('ROUNTING_ENDPOINT is not defined.')
  })

  it('should send directory request', async () => {
    (fetch as any).mockResponseOnce(directoryResponseXML)
    const [err, res] = await to(fetchDirectoryResponse())
    expect(err).toBeFalsy()
    expect(res).toBe(directoryResponseXML)
  })

  it('should send transaction request', async () => {
    (fetch as any).mockResponseOnce(transactionResponseXML)
    const [err, res] = await to(fetchTransactionResponse('issuerID', 'transactionID'))
    expect(err).toBeFalsy()
    expect(res).toBe(transactionResponseXML)
  })

  it('should send status request', async () => {
    (fetch as any).mockResponseOnce(statusResponseXML)
    const [err, res] = await to(fetchStatusResponse('transactionID'))
    expect(err).toBeFalsy()
    expect(res).toBe(statusResponseXML)
  })
})

describe('idin response', () => {
  it('should correctly parse the directory response', async () => {
    (fetch as any).mockResponseOnce(directoryResponseXML)
    const [err, res] = await to(getDirectoryResponse())
    expect(err).toBeFalsy()
    expect(res).toMatchSnapshot()
  })

  it('should correctly parse the transaction response', async () => {
    (fetch as any).mockResponseOnce(transactionResponseXML)
    const [err, res] = await to(getTransactionResponse('XXX', 'TXTID'))
    expect(err).toBeFalsy()
    expect(res).toMatchSnapshot()
  })

  it('should correctly parse and decrypt the status response', async () => {
    (fetch as any).mockResponseOnce(statusResponseXML)
    const [err, res] = await to(getStatusResponse('TXTID'))
    expect(err).toBeFalsy()
    expect(res).toMatchSnapshot()
  })
})
